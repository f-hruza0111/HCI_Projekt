<!-- <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="/">Home</a>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <% if(!userID) {%>
          <li class="nav-item">
            <a class="nav-link" href="/registration">Sign up</a>
          </li> 

          <li class="nav-item">
            <a class="nav-link" href="/login">Log in</a>
          </li> 
        
        
        <%} else {%>
          <li class="nav-item">
              <form action="/logout" method="post">
                <a class="nav-link" href="#" onclick="this.parentNode.submit()">Log out</a>
              </form>
              
          </li> 
        <% }%>      
      </ul>
    
    </div>

    <form class="form-inline">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
</nav> -->

<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4 fixed-top">
  <a class="navbar-brand" href="/">Blog App</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
			<path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
			</svg>
			Home
		</a>
      </li>

      <% if(!userID) { %>
        <li class="nav-item">
          
          <a class="nav-link" href="/registration">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-plus" viewBox="0 0 16 16">
			<path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
			<path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"/>
			</svg>
			Registration
		  </a>
        </li>

        <li class="nav-item">

          <a class="nav-link" href="/login">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
			<path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1"/>
			<path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117M11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5M4 1.934V15h6V1.077z"/>
			</svg>
			Login
		  </a>
        </li>
     <% } else { %> 
	 
	  <li class="nav-item">
        <a class="nav-link" href="/profile/<%=userID%>">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
			<path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
			</svg>
			My profile
		</a>
      </li>
	 
      <li class="nav-item">
        <a class="nav-link" href="/logout">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
			<path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"/>
			<path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"/>
			</svg>
			Logout
		</a>
      </li>
      <% } %>
    </ul>
  </div>
  <form class="form-inline my-lg-0 mx-3">
    <div class="input-group">
		<input class="form-control mr-sm-2" id="search" type="search" name="searchKey" placeholder="Search users" aria-label="Search" autocomplete="off">
		<button class="btn btn-outline-success my-2 my-sm-0" type="submit">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
			<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
			</svg>
			Search
		</button>
	</div>
	<div id="dropdown" class="dropdown-menu"></div>
  </form>
</nav>

<script>
  const searchBar = document.getElementById('search')
  const dropdown = document.getElementById('dropdown')
  searchBar.addEventListener('keyup', async (e) =>{
      // console.log('Search bar change')
      const searchKey = searchBar.value
      dropdown.replaceChildren()

      if(searchKey !== undefined && searchKey !== ''){

        fetch('/search?' + new URLSearchParams({
        searchKey: searchKey
        }))
        .then(res => {
            return res.json()
        })
        .then(res => {
            console.log(res)
            for(var user of res){
              const linkElement = document.createElement('a')
			  linkElement.classList.add('dropdown-item')
              linkElement.href ='/profile/' + user.id
              linkElement.textContent = user.username
              dropdown.appendChild(linkElement)
            }
			if (res.length == 0)
				dropdown.classList.remove('show')
			else
				dropdown.classList.add('show')
        })
        .catch(err => {
          console.log(err)
        })
      }
	  else
		dropdown.classList.remove('show')
      
  })
  
  window.onclick = function(e){
   if (!e.target.matches('.dropdown-menu')){
       dropdown.classList.remove('show')
   }
  }
</script>