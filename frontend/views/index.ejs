<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="css/style.css" rel="stylesheet" />
    <title>Blog App</title>
    <%- include('./partials/bootstrap') %>
</head>
<body class="bg-light">
    <%- include('./partials/navbar') %>
    <% if(err) { %>
        <div class="alert alert-danger" role="alert">
            <%=err%>
        </div>
    <% } %>
	
	<div style="height: 1vh"></div>
	
	<div class="container mt-5 pt-2">
	<div class="row m-1">
		<div class="col-lg-4"></div>
		<div class="col-lg-4 d-flex justify-content-center align-items-center"><h1>Home page</h1></div>
		<%if (userID) {%>
		<div class="col-lg-4 d-flex justify-content-end align-items-center"><a href="/post" class ="btn btn-primary">New post</a></div>
		<%}%>
	</div>
	</div>
		
	<div class="d-flex flex-column justify-content-center align-items-center">
		<%for (let post of posts) {%>
		<div id="<%=post.id%>" class="post">
			<div class="d-flex justify-content-between">
				<p class="m-0 text-grey">Posted by: <a class="fw-bold" href="/profile/<%=post.creatorID%>"><%=post.creatorUsername%></a></p>
				<p class="m-0 text-grey">Created on: <%=post.createdOn%>
					<%if (post.editedOn != ''){%>
						, Last modified: <%=post.editedOn%>
					<%}%>
				</p>
			</div>
			<hr class="m-0 mt-1">
			
			<h3 class="my-3 text-start fw-bold"><%=post.title%></h3>
			
			<p class="text-start mt-4"><%=post.content%></p>
			<%if (post.picture && post.picture.length != 0) {%>
			<image class="border rounded-2 mb-3" src="<%=post.picture%>"></image>
			<%}%>
			
			
			<div class="text-start mb-3">
				<a class="btn
					<%if (post.userLiked) {%>
						btn-primary" href="/like/<%=post.id%>">Liked (<%=post.likes%>)
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down" viewBox="0 0 16 16">
							<path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"/>
						</svg>
					<%}
					else {%>
						btn-secondary" href="/like/<%=post.id%>">Like (<%=post.likes%>)
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16">
							<path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5"/>
						</svg>
					<%}%>
				</a>
			</div>
			
			<div class="d-flex mb-3 align-items-center">
				<a class="text-small text-grey" data-bs-toggle="collapse" href="#Comments" role="button" aria-expanded="false" aria-controls="collapseComments">
					Toggle comments (<%=post.comments.length%>)
				</a>&nbsp
				<hr class="m-0 my-1 flex-fill">
			</div>
			<div class="collapse" id="Comments">
				
				<form method="post" action="/comment">
					<label for="commentText">Comment:</label>
					<input type="text" name="commentText" class="form-control">
					<input type="hidden" name="postID" value="<%=post.id%>">
					<button type="submit" class="btn btn-primary">Send</button>
				</form>
			</div>
		</div>
		<%}%>
	</div>
   
</body>
</html>